# Webアプリケーションのアーキテクチャ

ウェブ技術として、過去には、「いかにロジックとデザインを分離させるか」という課題があった。

ロジックとは、直訳すると論理や理屈という意味になるが、アプリケーション開発においてはコンピュータに行わせる処理のことをロジックと呼びます。


ロジックとデザインでは必要とされるスキルが異なるため、それぞれプログラマとデザイナが分業した方が品質、効率が上がります。アプリケーションを効率良く開発するためには、結果としてロジックとデザインを分離させることが必要なのです。


## MVCモデルによるWebアプリケーションのアーキテクチャ

アプリケーションの処理は、大きく分けると「入力」、「処理」、「出力」に分けられる。

そして、これらの情報の流れを踏まえたウェブアプリケーションのアーキテクチャとして、
「MVCモデル」がある。

MVCでは、モデル、ビュー、コントローラの３つに役割を分けて作成されます。

* model・・・モデルはアプリケーションの処理の部分とそれに関する情報の保持を担当します。

* view・・・ビューはモデルによる処理結果の画面への表示を担当します。処理結果自体はモデルが持っているので、ビューがモデルから処理結果を取り出して、ユーザーが見やすいように整形した上で画面へ表示します。モデルとは逆で、あくまで画面への表示がその役割であり、情報の処理には一切関わりません。

* controller・・・コントローラは画面からの情報の入力と、モデルの呼び出し及びその結果に従ったビューの呼び出しを担当します。コンとローラはユーザーが画面に入力した情報を取り出して、処理を担当するモデルに渡します。モデルの処理結果によって結果を表示するビューを選択して、呼び出します。名前の通り、全体の流れを制御するわけです。

## レイヤーパターンによるデータアクセス層の分離

Javaでは、データベースへアクセスするためのAPIとして、JDBCが用意されています。JDBCを使って、データベースに対してSQLを発行して結果を取得することができます。


APIとは、オペレーティングシステムやプログラミング言語が用意したライブラリをアプリケーションから利用するための入り口となるものです、Javaの場合は、標準で憑依される各種クラスがAPIとなります。

レイヤとは階層のことですが、Layersパターンはシステムを階層化し、上位レイヤが下位レイヤの提供する機能を利用することで、各レイヤの作りを単純化していく考え方です。ここでポイントとなるのは、各レイヤはそのレイヤが依存する直接の下位レイヤ以外を知る必要がないということです。例えば、下記の図では、レイヤ２はその下位レイヤであるレイヤ３に依存します。レイヤ２が意識するのはレイヤ２自身とレイヤ３のみであり、上位レイヤであるレイヤ１やレイヤ３より下位のレイヤを意識する必要はありません。

図をここに書く。

* プレゼンテーション層・・・プレゼンテーション層はシステム利用者とのインターフェイスを担当するレイヤです。ユーザーからの入力を受け付けて、下位レイヤであるビジネスロジック層へ渡し、処理結果を再びウェブブラウザへ表示したり、画面遷移を制御したりといったことを担当するのがその役目です。

* ビジネスロジック層・・・ビジネスロジック層は、アプリケーションが実現すべき固有の処理を実現するためのレイヤです。ビジネスロジックは「業務ロジック」と訳されます。ビジネスロジックはユーザーが入力した情報をプレゼンテーション層から受けとり、必要に応じてデータアクセス層へ通じてデータベースを利用し、処理を実行します。処理結果は再びプレゼンテーション層へ返します。

* データアクセス層・・・データアクセス層とは、ビジネスロジック層とデータベースの仲立ちを行うためのレイヤです。データベースへのアクセス部分は多くのコードを記述しないといけないため、ビジネスロジックから切り離し、データベースへの細やかなアクセス手順を意識せずとも利用できるようにすることが、データアクセス層の役割なります。


## ORマッパーについて

O/Rマッピングとは、O/RとはObject/Relationalのことを指し、O/Rマッピングとはプログラミング言語のオブジェクトとリレーショナルデータベースの対応をとる、という意味になります。

リレーショナル・データベース上の表現とオブジェクト指向言語における表現の違いを「インピーダンス・ミスマッチ」と呼んでいます。インピーダンスとは、電気抵抗のことで、インピーダンスミスマッチとは本来電気工学の用語ですが、リレーショナルデータベースとオブジェクト指向の考え方の違いをなぞらえてこのように呼んでいます。

このインピーダンス・ミスマッチを解決することが「O/Rマッピングフレームワーク」の最大の役割となります。データベースjとの接続を管理したり、情報をキャッシングしてデータベースアクセスを高速化したりといった機能も提供しますが、 これらは副次的なものといえます。O/Rマッピングフレームワークが登場する前に、JDBCを利用してデータベースから情報を取得し、それをJavaのオブジェクトに組み立て直すという単純なコードを大量に書かないといけませんでした。プログラム自体は難しくないですが、バグを埋め込んでしまう可能性があります。ORマッピングフレームワークを利用することで、このようなリスクを回避し、作業自体を効率化することができます。
